



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Distributed Asynchronous Object Storage">
      
      
        <link rel="canonical" href="http://daos.io/user/posix/">
      
      
        <meta name="author" content="DAOS Project">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-4.6.3">
    
    
      
        <title>POSIX Namespace - DAOS v1.0</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.adb8469c.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.a8b3c06d.css">
      
      
        
        
        <meta name="theme-color" content="#546e7a">
      
    
    
      <script src="../../assets/javascripts/modernizr.86422ebf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,400i,700%7CUbuntu+Mono&display=fallback">
        <style>body,input{font-family:"Ubuntu","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Ubuntu Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="blue-grey" data-md-color-accent="blue">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#posix-namespace" tabindex="0" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="http://daos.io" title="DAOS v1.0" aria-label="DAOS v1.0" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              DAOS v1.0
            </span>
            <span class="md-header-nav__topic">
              
                POSIX Namespace
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" aria-label="search" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/daos-stack/daos/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    daos-stack/daos
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  <li class="md-tabs__item">
    
      <a href="../.." class="md-tabs__link">
        Home
      </a>
    
  </li>

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../overview/terminology/" class="md-tabs__link">
          Architecture Overview
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../admin/hardware/" class="md-tabs__link">
          Administration Guide
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../container/" class="md-tabs__link md-tabs__link--active">
          User Guide
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../release/release_notes_v1_0/" class="md-tabs__link">
          Releases
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../dev/development/" class="md-tabs__link">
          Developer Zone
        </a>
      
    </li>
  

      
        
      
        
      
        
      
        
      
    </ul>
  </div>
</nav>
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="http://daos.io" title="DAOS v1.0" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    DAOS v1.0
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/daos-stack/daos/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    daos-stack/daos
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Architecture Overview
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Architecture Overview
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../overview/terminology/" title="Terminology" class="md-nav__link">
      Terminology
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../overview/architecture/" title="Architecture" class="md-nav__link">
      Architecture
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../overview/storage/" title="Storage Model" class="md-nav__link">
      Storage Model
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../overview/transaction/" title="Transaction Model" class="md-nav__link">
      Transaction Model
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../overview/fault/" title="Fault Model" class="md-nav__link">
      Fault Model
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../overview/security/" title="Security Model" class="md-nav__link">
      Security Model
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../overview/data_integrity/" title="Data Integrity" class="md-nav__link">
      Data Integrity
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Administration Guide
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Administration Guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../admin/hardware/" title="Hardware Requirements" class="md-nav__link">
      Hardware Requirements
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../admin/installation/" title="Software Installation" class="md-nav__link">
      Software Installation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../admin/predeployment_check/" title="Pre-deployment Checklist" class="md-nav__link">
      Pre-deployment Checklist
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../admin/deployment/" title="System Deployment" class="md-nav__link">
      System Deployment
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../admin/administration/" title="System Administration" class="md-nav__link">
      System Administration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../admin/pool_operations/" title="Pool Operations" class="md-nav__link">
      Pool Operations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../admin/tiering_uns/" title="Tiering and Unified Namespace" class="md-nav__link">
      Tiering and Unified Namespace
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../admin/performance_tuning/" title="Performance Tuning" class="md-nav__link">
      Performance Tuning
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../admin/troubleshooting/" title="Troubleshooting" class="md-nav__link">
      Troubleshooting
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../admin/utilities_examples/" title="Utilities and Usage Examples" class="md-nav__link">
      Utilities and Usage Examples
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../admin/env_variables/" title="Environment Variables" class="md-nav__link">
      Environment Variables
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      User Guide
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        User Guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../container/" title="Container Management" class="md-nav__link">
      Container Management
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../interface/" title="Native Programming Interface" class="md-nav__link">
      Native Programming Interface
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        POSIX Namespace
      </label>
    
    <a href="./" title="POSIX Namespace" class="md-nav__link md-nav__link--active">
      POSIX Namespace
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#libdfs" class="md-nav__link">
    libdfs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dfuse" class="md-nav__link">
    DFuse
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dfuse-daemon" class="md-nav__link">
    DFuse Daemon
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#restrictions" class="md-nav__link">
    Restrictions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#launching" class="md-nav__link">
    Launching
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#poolcontainer-paths" class="md-nav__link">
    Pool/Container Paths
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#links-into-other-containers" class="md-nav__link">
    Links into other Containers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enabling-caching" class="md-nav__link">
    Enabling Caching
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stopping-dfuse" class="md-nav__link">
    Stopping DFuse
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#interception-library" class="md-nav__link">
    Interception Library
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../mpi-io/" title="MPI-IO Support" class="md-nav__link">
      MPI-IO Support
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../hdf5/" title="HDF5 Support" class="md-nav__link">
      HDF5 Support
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../spark/" title="Spark and Hadoop" class="md-nav__link">
      Spark and Hadoop
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Releases
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Releases
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/release_notes_v1_0/" title="Release Notes" class="md-nav__link">
      Release Notes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/support_matrix/" title="Support Matrix" class="md-nav__link">
      Support Matrix
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Developer Zone
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Developer Zone
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../dev/development/" title="Dev Environment" class="md-nav__link">
      Dev Environment
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../dev/contributing/" title="Contributing" class="md-nav__link">
      Contributing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="https://github.com/daos-stack/daos/blob/master/src/README.md" title="DAOS Internals" class="md-nav__link">
      DAOS Internals
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../html/" title="DAOS API Documentation" class="md-nav__link">
      DAOS API Documentation
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="https://wiki.hpdd.intel.com" title="Community Wiki" class="md-nav__link">
      Community Wiki
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="https://wiki.hpdd.intel.com/display/DC/Roadmap/" title="Roadmap" class="md-nav__link">
      Roadmap
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="https://daos.groups.io/g/daos" title="Mailing list" class="md-nav__link">
      Mailing list
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="https://jira.hpdd.intel.com/projects/DAOS" title="Issue tracker" class="md-nav__link">
      Issue tracker
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#libdfs" class="md-nav__link">
    libdfs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dfuse" class="md-nav__link">
    DFuse
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dfuse-daemon" class="md-nav__link">
    DFuse Daemon
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#restrictions" class="md-nav__link">
    Restrictions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#launching" class="md-nav__link">
    Launching
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#poolcontainer-paths" class="md-nav__link">
    Pool/Container Paths
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#links-into-other-containers" class="md-nav__link">
    Links into other Containers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enabling-caching" class="md-nav__link">
    Enabling Caching
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stopping-dfuse" class="md-nav__link">
    Stopping DFuse
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#interception-library" class="md-nav__link">
    Interception Library
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/daos-stack/daos/edit/master/docs/user/posix.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="posix-namespace">POSIX Namespace<a class="headerlink" href="#posix-namespace" title="Permanent link">&para;</a></h1>
<p>A regular POSIX namespace can be encapsulated into a DAOS container.  This
capability is provided by the <code>libdfs</code> library that implements the file and
directory abstractions over the native <code>libdaos</code> library. The POSIX emulation can
be exposed directly to applications or I/O frameworks (e.g., for
frameworks like Spark or TensorFlow, or benchmarks like IOR or mdtest that support
different storage backend plugins). 
It can also be exposed transparently via a FUSE daemon, combined
optionally with an interception library to address some of the FUSE performance
bottlenecks by delivering full OS bypass for POSIX read/write operations.</p>
<p><img alt="../graph/posix.png" src="../../graph/posix.png" title="POSIX I/O Support" /></p>
<h2 id="libdfs">libdfs<a class="headerlink" href="#libdfs" title="Permanent link">&para;</a></h2>
<p>The DAOS File System (DFS) is implemented in the <code>libdfs</code> library, 
and allows a DAOS container to be accessed as a hierarchical POSIX namespace.
<code>libdfs</code> supports files, directories, and symbolic links, but not hard links. 
Access permissions are inherited from
the parent pool and are not implemented on a per-file or per-directory basis.
<code>setuid()</code> and <code>setgid()</code> programs, as well as supplementary groups, 
are currently not supported.</p>
<p>It is possible to use <code>libdfs</code> in a parallel application from multiple nodes.
When the same POSIX container is mounted concurrently by multiple
processes, a few limitations exist in DAOS v1.0. In particular:</p>
<ul>
<li>Unlinking a file in one process while another process has the same file
  open: This may or may not cause an I/O error on the open file.</li>
<li>The atomicity of rename operations is not guaranteed.</li>
</ul>
<p>These corner cases will be addressed in a future DAOS release. </p>
<h2 id="dfuse">DFuse<a class="headerlink" href="#dfuse" title="Permanent link">&para;</a></h2>
<p>DFuse provides DAOS File System access through the standard libc/kernel/VFS
POSIX infrastructure.  This allows existing applications to use DAOS without
modification, and provides a path to upgrade those applications to native DAOS
support.  Additionally, DFuse provides an Interception Library <code>libioil</code> to transparently
allow POSIX clients to talk directly to DAOS servers, providing OS-Bypass for
I/O without modifying or recompiling of the application.</p>
<p>DFuse builds heavily on DFS. Data written via DFuse can be accessed by DFS and
vice versa.</p>
<h3 id="dfuse-daemon">DFuse Daemon<a class="headerlink" href="#dfuse-daemon" title="Permanent link">&para;</a></h3>
<p>The <code>dfuse</code> daemon runs a single instance per node to provide a user POSIX access
to DAOS. It should be run with the credentials of the user, and typically will
be started and stopped on each compute node as part of the prolog and epilog
scripts of any resource manager or scheduler in use.  One DFuse daemon per node
can process requests for multiple clients.</p>
<p>A single DFuse instance can provide access to multiple pools and containers
concurrently, or can be limited to a single pool, or a single container.</p>
<h3 id="restrictions">Restrictions<a class="headerlink" href="#restrictions" title="Permanent link">&para;</a></h3>
<p>DFuse is limited to a single user. Access to the filesystem from other users,
including root, will not be honored. As a consequence of this, the <code>chown</code>
and <code>chgrp</code> calls are not supported.  Hard links and special device files, except
symbolic links, are not supported, nor are any ACLs.</p>
<p>DFuse can run in the foreground, keeping the terminal window open, or it can
daemonize to run like a system daemon. 
However, to do this and still be
able to access DAOS it needs to daemonize before calling <code>daos_init()</code>. 
This in turns means it cannot report some kinds of startup errors either on
stdout/stderr or via its return code.<br />
When initially starting with DFuse it is recommended to run in foreground mode 
(<code>--foreground</code>) to better observe any failures.</p>
<p>Inodes are managed on the local node by DFuse. So while inode numbers
will be consistent on a node for the duration of the session, they are not
guaranteed to be consistent across restarts of DFuse or across nodes.</p>
<p>It is not possible to see pool/container listings through DFuse. 
So if <code>readdir</code>, <code>ls</code> or others are used, DFuse will return <code>ENOTSUP</code>.</p>
<h3 id="launching">Launching<a class="headerlink" href="#launching" title="Permanent link">&para;</a></h3>
<p>DFuse should be run with the credentials (user/group) of the user who will
be accessing it, and who owns any pools that will be used.</p>
<p>There are two mandatory command-line options, these are:</p>
<table>
<thead>
<tr>
<th><strong>Command-line Option</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>--mountpoint=&lt;path></td>
<td>path to mount dfuse</td>
</tr>
</tbody>
</table>
<p>The mount point specified should be an empty directory on the local node that
is owned by the user.</p>
<p>Additionally, there are several optional command-line options:</p>
<table>
<thead>
<tr>
<th><strong>Command-line Option</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>--pool=&lt;uuid></td>
<td>pool uuid to connect to</td>
</tr>
<tr>
<td>--container=&lt;uuid></td>
<td>container uuid to open</td>
</tr>
<tr>
<td>--sys-name=&lt;name></td>
<td>DAOS system name</td>
</tr>
<tr>
<td>--foreground</td>
<td>run in foreground</td>
</tr>
<tr>
<td>--singlethreaded</td>
<td>run single threaded</td>
</tr>
</tbody>
</table>
<p>When DFuse starts, it will register a single mount with the kernel, at the
location specified by the <code>--mountpoint</code> option. This mount will be
visible in <code>/proc/mounts</code>, and possibly in the output of <code>df</code>.<br />
The contents of multiple pools/containers will be accessible via this 
single kernel mountpoint.</p>
<h3 id="poolcontainer-paths">Pool/Container Paths<a class="headerlink" href="#poolcontainer-paths" title="Permanent link">&para;</a></h3>
<p>DFuse will only create one kernel level mount point regardless of how it is
launched. How POSIX containers are represented within that mount point varies 
depending on the DFuse command-line options:</p>
<p>If both a pool uuid and a container uuid are specified on the command line, then 
the mount point will map to the root of the container itself. Files can be
accessed by simply concatenating the mount point and the name of the file,
relative to the root of the container.</p>
<p>If neither a pool or container is specified, then pools and container can be
accessed by the path <code>&lt;mount point&gt;/&lt;pool uuid&gt;/&lt;container uuid&gt;</code>. However it
should be noted that <code>readdir()</code> and therefore <code>ls</code> do not work on either mount
points or directories representing pools here. So the pool and container uuids
will have to be provided from an external source.</p>
<p>If a pool uuid is specified but not a container uuid, then the containers can be
accessed by the path <code>&lt;mount point&gt;/&lt;container uuid&gt;</code>. The container uuid
will have to be provided from an external source.</p>
<p>It is anticipated that in most cases, both pool uuid and container uuid will be
used, so the mount point itself will map directly onto a POSIX container.</p>
<h3 id="links-into-other-containers">Links into other Containers<a class="headerlink" href="#links-into-other-containers" title="Permanent link">&para;</a></h3>
<p>It is possible to link to other containers in DFuse, where subdirectories
within a container resolve not to regular directories, but rather to
the root of entirely different POSIX containers.</p>
<p>To create a new container and link it into the namespace of an existing one,
use the following command.</p>
<pre><code class="bash">$ daos container create --type POSIX --pool &lt;pool uuid&gt; --path &lt;path to entry point&gt;
</code></pre>

<p>The pool uuid should already exist, and the path should specify a location
somewhere within a DFuse mount point that resolves to a POSIX container.
Once a link is created, it can be accessed through the new path. Following
the link is virtually transparent.  No container uuid is required. If one is
not supplied, it will be created.</p>
<p>To destroy a container again, the following command should be used.</p>
<pre><code class="bash">$ daos container destroy --path &lt;path to entry point&gt;
</code></pre>

<p>This will both remove the link between the containers and remove the container
that was linked to.</p>
<p>There is no support for adding links to already existing containers or removing
links to containers without also removing the container itself.</p>
<p>Information about a container, for example, the presence of an entry point between
containers, or the pool and container uuids of the container linked to can be
read with the following command.</p>
<pre><code class="bash">$ daos container info --path &lt;path to entry point&gt;
</code></pre>

<h3 id="enabling-caching">Enabling Caching<a class="headerlink" href="#enabling-caching" title="Permanent link">&para;</a></h3>
<p>DFuse in normal mode simply provides a communication path between the kernel and
DAOS. However, this can come with a performance impact. To help alleviate this
it is possible to turn on caching, both within dfuse itself and by allowing the
kernel to cache certain data.  Where and when data is cached, there is no attempt
made to invalidate the caches based on changes to DAOS, other than simple timeouts.</p>
<p>Enabling this option will turn on the following features:</p>
<ul>
<li>Kernel caching of dentries</li>
<li>Kernel caching of negative dentries</li>
<li>Kernel caching of inodes (file sizes, permissions etc)</li>
<li>Kernel caching of file contents</li>
<li>Readahead in dfuse and inserting data into kernel cache</li>
<li>MMAP write optimization</li>
</ul>
<p>To turn on caching use the <code>--enable-caching</code> command-line option for dfuse. This
will enable the feature for all accessed containers.  When this option is used,
the containers accessed should only be accessed from one node, so it may
be necessary to create a container per node in this model.</p>
<h3 id="stopping-dfuse">Stopping DFuse<a class="headerlink" href="#stopping-dfuse" title="Permanent link">&para;</a></h3>
<p>When done, the file system can be unmounted via fusermount:</p>
<pre><code class="bash">$ fusermount3 -u /tmp/daos
</code></pre>

<p>When this is done, the local DFuse daemon should shut down the mount point,
disconnect from the DAOS servers, and exit.  You can also verify that the
mount point is no longer listed in <code>/proc/mounts</code>.</p>
<h3 id="interception-library">Interception Library<a class="headerlink" href="#interception-library" title="Permanent link">&para;</a></h3>
<p>An interception library called <code>libioil</code> is available to work with DFuse. This
library works in conjunction with DFuse and allows the interception of POSIX I/O
calls and issue the I/O operations directly from the application context through
<code>libdaos</code> without any application changes.  This provides kernel-bypass for I/O data,
leading to improved performance.
To use this, set <code>LD_PRELOAD</code> to point to the shared library in the DAOS install
directory:</p>
<pre><code>LD_PRELOAD=/path/to/daos/install/lib/libioil.so
LD_PRELOAD=/usr/lib64/libioil.so # when installed from RPMs
</code></pre>
                
                  
                
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../interface/" title="Native Programming Interface" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Native Programming Interface
              </span>
            </div>
          </a>
        
        
          <a href="../mpi-io/" title="MPI-IO Support" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                MPI-IO Support
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org" target="_blank" rel="noopener">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.c33a9706.js"></script>
      
      <script>app.initialize({version:"1.1.2",url:{base:"../.."}})</script>
      
    
  </body>
</html>