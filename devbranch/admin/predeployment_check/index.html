



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Distributed Asynchronous Object Storage">
      
      
        <link rel="canonical" href="http://daos.io/admin/predeployment_check/">
      
      
        <meta name="author" content="DAOS Project">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-4.6.3">
    
    
      
        <title>Pre-deployment Checklist - DAOS Development Branch</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.adb8469c.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.a8b3c06d.css">
      
      
        
        
        <meta name="theme-color" content="#546e7a">
      
    
    
      <script src="../../assets/javascripts/modernizr.86422ebf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,400i,700%7CUbuntu+Mono&display=fallback">
        <style>body,input{font-family:"Ubuntu","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Ubuntu Mono","Courier New",Courier,monospace}</style>
<link rel="stylesheet" href="../../assets/fonts/material-icons.css">
<link href="../../css/bootstrap-4.4.1.css" rel="stylesheet" type="text/css">
<link href="../../assets/stylesheets/styles_1.css" rel="stylesheet" type="text/css">
</head>
  
    
    
    <body dir="ltr" data-md-color-primary="blue-grey" data-md-color-accent="blue">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#pre-deployment-checklist" tabindex="0" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
           <div class="md-flex"><img src="../../assets/images/daos_logo_wh.png" width="80" height="61" alt=""/> 

      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              DAOS Development Branch
            </span>
            <span class="md-header-nav__topic">
              
                Pre-deployment Checklist
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" aria-label="search" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/daos-stack/daos/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    daos-stack/daos
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  <li class="md-tabs__item">
    
      <a href="../.." class="md-tabs__link">
        Home
      </a>
    
  </li>

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../overview/terminology/" class="md-tabs__link">
          Architecture Overview
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../hardware/" class="md-tabs__link md-tabs__link--active">
          Administration Guide
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../user/container/" class="md-tabs__link">
          User Guide
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../release/release_notes_v1_0/" class="md-tabs__link">
          Releases
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../dev/development/" class="md-tabs__link">
          Developer Zone
        </a>
      
    </li>
  

      
        
      
        
      
        
      
        
      
    </ul>
  </div>
</nav>
  <section>
      <div class="dropdown show">
  <div class="dropdown show col-xl-12"> <a class="btn btn-sm dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> DAOS Version</a>
    <div class="dropdown-menu"> <a class="dropdown-header">Select Version</a> <a class="dropdown-item disabled" href="devbranch/index.html">Dev Branch</a> <a class="dropdown-item" href="../../../index.html">1.2</a><a class="dropdown-item" href="../../../v1.0/index.html">1.0</a> </div>
  </div>
      </div>

  </section>
  <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="http://daos.io" title="DAOS Development Branch" class="md-nav__button md-logo">
      
        <i class="md-icon">î Œ</i>
      
    </a>
    DAOS Development Branch
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/daos-stack/daos/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    daos-stack/daos
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Architecture Overview
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Architecture Overview
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../overview/terminology/" title="Terminology" class="md-nav__link">
      Terminology
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../overview/architecture/" title="Architecture" class="md-nav__link">
      Architecture
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../overview/storage/" title="Storage Model" class="md-nav__link">
      Storage Model
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../overview/transaction/" title="Transaction Model" class="md-nav__link">
      Transaction Model
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../overview/fault/" title="Fault Model" class="md-nav__link">
      Fault Model
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../overview/security/" title="Security Model" class="md-nav__link">
      Security Model
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      Administration Guide
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Administration Guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../hardware/" title="Hardware Requirements" class="md-nav__link">
      Hardware Requirements
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../installation/" title="Software Installation" class="md-nav__link">
      Software Installation
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Pre-deployment Checklist
      </label>
    
    <a href="./" title="Pre-deployment Checklist" class="md-nav__link md-nav__link--active">
      Pre-deployment Checklist
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#enable-iommu-optional" class="md-nav__link">
    Enable IOMMU (Optional)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#time-synchronization" class="md-nav__link">
    Time Synchronization
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usergroup-synchronization" class="md-nav__link">
    User/Group Synchronization
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multi-railnic-setup" class="md-nav__link">
    Multi-rail/NIC Setup
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#subnet" class="md-nav__link">
    Subnet
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#infinibandroce" class="md-nav__link">
    Infiniband/RoCE
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#runtime-directory-setup" class="md-nav__link">
    Runtime Directory Setup
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#non-default-directory" class="md-nav__link">
    Non-default Directory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#default-directory-non-persistent" class="md-nav__link">
    Default Directory (non-persistent)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#default-directory-persistent" class="md-nav__link">
    Default Directory (persistent)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elevated-privileges" class="md-nav__link">
    Elevated Privileges
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#privileged-helper-configuration" class="md-nav__link">
    Privileged Helper Configuration
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#memory-lock-limits" class="md-nav__link">
    Memory Lock Limits
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../deployment/" title="System Deployment" class="md-nav__link">
      System Deployment
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../administration/" title="System Administration" class="md-nav__link">
      System Administration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../pool_operations/" title="Pool Operations" class="md-nav__link">
      Pool Operations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tiering_uns/" title="Tiering and Unified Namespace" class="md-nav__link">
      Tiering and Unified Namespace
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../performance_tuning/" title="Performance Tuning" class="md-nav__link">
      Performance Tuning
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../troubleshooting/" title="Troubleshooting" class="md-nav__link">
      Troubleshooting
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../utilities_examples/" title="Utilities and Usage Examples" class="md-nav__link">
      Utilities and Usage Examples
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../env_variables/" title="Environment Variables" class="md-nav__link">
      Environment Variables
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      User Guide
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        User Guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../user/container/" title="Container Management" class="md-nav__link">
      Container Management
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user/interface/" title="Native Programming Interface" class="md-nav__link">
      Native Programming Interface
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user/posix/" title="POSIX Namespace" class="md-nav__link">
      POSIX Namespace
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user/mpi-io/" title="MPI-IO Support" class="md-nav__link">
      MPI-IO Support
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user/hdf5/" title="HDF5 Support" class="md-nav__link">
      HDF5 Support
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user/spark/" title="Spark and Hadoop" class="md-nav__link">
      Spark and Hadoop
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user/datamover/" title="Data Mover" class="md-nav__link">
      Data Mover
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Releases
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Releases
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/release_notes_v1_0/" title="Release Notes v1.0" class="md-nav__link">
      Release Notes v1.0
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/support_matrix/" title="Support Matrix" class="md-nav__link">
      Support Matrix
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Developer Zone
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Developer Zone
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../dev/development/" title="Dev Environment" class="md-nav__link">
      Dev Environment
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../dev/contributing/" title="Contributing" class="md-nav__link">
      Contributing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="https://github.com/daos-stack/daos/blob/master/src/README.md" title="DAOS Internals" class="md-nav__link">
      DAOS Internals
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../html/" title="DAOS API Documentation" class="md-nav__link">
      DAOS API Documentation
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="https://wiki.hpdd.intel.com" title="Community Wiki" class="md-nav__link">
      Community Wiki
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="https://wiki.hpdd.intel.com/display/DC/Roadmap/" title="Roadmap" class="md-nav__link">
      Roadmap
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="https://daos.groups.io/g/daos" title="Mailing list" class="md-nav__link">
      Mailing list
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="https://jira.hpdd.intel.com/projects/DAOS" title="Issue tracker" class="md-nav__link">
      Issue tracker
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#enable-iommu-optional" class="md-nav__link">
    Enable IOMMU (Optional)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#time-synchronization" class="md-nav__link">
    Time Synchronization
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usergroup-synchronization" class="md-nav__link">
    User/Group Synchronization
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multi-railnic-setup" class="md-nav__link">
    Multi-rail/NIC Setup
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#subnet" class="md-nav__link">
    Subnet
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#infinibandroce" class="md-nav__link">
    Infiniband/RoCE
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#runtime-directory-setup" class="md-nav__link">
    Runtime Directory Setup
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#non-default-directory" class="md-nav__link">
    Non-default Directory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#default-directory-non-persistent" class="md-nav__link">
    Default Directory (non-persistent)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#default-directory-persistent" class="md-nav__link">
    Default Directory (persistent)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elevated-privileges" class="md-nav__link">
    Elevated Privileges
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#privileged-helper-configuration" class="md-nav__link">
    Privileged Helper Configuration
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#memory-lock-limits" class="md-nav__link">
    Memory Lock Limits
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/daos-stack/daos/edit/master/docs/admin/predeployment_check.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="pre-deployment-checklist">Pre-deployment Checklist<a class="headerlink" href="#pre-deployment-checklist" title="Permanent link">&para;</a></h1>
<p>This section covers the preliminary setup required on the compute and
storage nodes before deploying DAOS.</p>
<h2 id="enable-iommu-optional">Enable IOMMU (Optional)<a class="headerlink" href="#enable-iommu-optional" title="Permanent link">&para;</a></h2>
<p>In order to run the DAOS server as a non-root user with NVMe devices, the hardware
must support virtualized device access, and it must be enabled in the system BIOS.
On IntelÂ® systems, this capability is named IntelÂ® Virtualization Technology for
Directed I/O (VT-d). Once enabled in BIOS, IOMMU support must also be enabled in
the Linux kernel. Exact details depend on the distribution, but the following
example should be illustrative:</p>
<pre><code class="bash"># Enable IOMMU on CentOS 7
# All commands must be run as root/sudo!

$ sudo vi /etc/default/grub # add the following line:
GRUB_CMDLINE_LINUX_DEFAULT=&quot;intel_iommu=on&quot;

# after saving the file, run the following to reconfigure
# the bootloader:
$ sudo grub2-mkconfig --output=/boot/grub2/grub.cfg

# if the command completed with no errors, reboot the system
# in order to make the changes take effect
$ sudo reboot
</code></pre>

<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>VFIO support is a new feature for DAOS 1.2 and has been tested on CentOS 7.7</p>
</div>
<p>To force SPDK to use UIO rather than VFIO at daos_server runtime, set
'disable_vfio' in the
<a href="https://github.com/daos-stack/daos/blob/master/utils/config/daos_server.yml#L109">server config file</a>,
but note that this will require running daos_server as root.</p>
<h2 id="time-synchronization">Time Synchronization<a class="headerlink" href="#time-synchronization" title="Permanent link">&para;</a></h2>
<p>The DAOS transaction model relies on timestamps and requires time to be
synchronized across all the storage and client nodes. This can be done
using NTP or any other equivalent protocol.</p>
<h2 id="usergroup-synchronization">User/Group Synchronization<a class="headerlink" href="#usergroup-synchronization" title="Permanent link">&para;</a></h2>
<p>DAOS ACLs store the actual user and group names (instead of numeric IDs), and
therefore the servers do not need access to a synchronized user/group database.
The DAOS Agent (running on the client nodes) is responsible for resolving
UID/GID to user/group names which are added to a signed credential and sent to
the DAOS storage nodes.</p>
<h2 id="multi-railnic-setup">Multi-rail/NIC Setup<a class="headerlink" href="#multi-railnic-setup" title="Permanent link">&para;</a></h2>
<p>Storage nodes can be configured with multiple network interfaces to run
multiple engine instances.</p>
<h3 id="subnet">Subnet<a class="headerlink" href="#subnet" title="Permanent link">&para;</a></h3>
<p>Since all DAOS engines need to be able to communicate, the different network
interfaces need to be on the same subnet or routing capabilities across the
different subnet might be configured.</p>
<h3 id="infinibandroce">Infiniband/RoCE<a class="headerlink" href="#infinibandroce" title="Permanent link">&para;</a></h3>
<p>Some special configuration is required to use librdmacm with multiple
interfaces.</p>
<p>Firstly, the accept_local feature must be enabled on the network interfaces
to be used by DAOS. This can be done using the following command (<ifaces> must
be replaced with the interface names):</p>
<pre><code>$ sudo sysctl -w net.ipv4.conf.all.accept_local=1
</code></pre>

<p>Secondly, Linux must be configured to only send ARP replies on the interface
targeted in the ARP request. This is configured via the arp_ignore parameter.
This should be set to 2 if all the IPoIB interfaces on the client and storage
nodes are in the same logical subnet (e.g. ib0 == 10.0.0.27, ib1 == 10.0.1.27,
prefix=16).</p>
<pre><code>$ sysctl -w net.ipv4.conf.all.arp_ignore=2
</code></pre>

<p>If separate logical subnets are used (e.g. prefix = 24), then the value must be
set to 1.</p>
<pre><code>$ sysctl -w net.ipv4.conf.all.arp_ignore=1
</code></pre>

<p>Finally, the rp_filter is set to 1 by default on several distributions (e.g. on
CentOS 7) and should be set to either 0 or 2, with 2 being more secure. This is
true even if the configuration uses a single logical subnet.</p>
<pre><code>$ sysctl -w net.ipv4.conf.&lt;ifaces&gt;.rp_filter=2
</code></pre>

<p>All those parameters can be made persistent in /etc/sysctl.conf by adding a new
sysctl file under /etc/sysctl.d (e.g. /etc/sysctl.d/95-daos-net.conf) with all
the relevant settings.</p>
<p>For more information, please refer to the <a href="https://github.com/linux-rdma/rdma-core/blob/master/Documentation/librdmacm.md">librdmacm documentation</a></p>
<h2 id="runtime-directory-setup">Runtime Directory Setup<a class="headerlink" href="#runtime-directory-setup" title="Permanent link">&para;</a></h2>
<p>DAOS uses a series of Unix Domain Sockets to communicate between its
various components. On modern Linux systems, Unix Domain Sockets are
typically stored under /run or /var/run (usually a symlink to /run) and
are a mounted tmpfs file system. There are several methods for ensuring
the necessary directories are setup.</p>
<p>A sign that this step may have been missed is when starting daos_server
or daos_agent, you may see the message:</p>
<pre><code class="bash">$ mkdir /var/run/daos_server: permission denied
Unable to create socket directory: /var/run/daos_server
</code></pre>

<h3 id="non-default-directory">Non-default Directory<a class="headerlink" href="#non-default-directory" title="Permanent link">&para;</a></h3>
<p>By default, daos_server and daos_agent will use the directories
/var/run/daos_server and /var/run/daos_agent respectively. To change
the default location that daos_server uses for its runtime directory,
either uncomment and set the socket_dir configuration value in
install/etc/daos_server.yml, or pass the location to daos_server on
the command line using the -d flag. For the daos_agent, an alternate
location can be passed on the command line using the --runtime_dir flag.</p>
<h3 id="default-directory-non-persistent">Default Directory (non-persistent)<a class="headerlink" href="#default-directory-non-persistent" title="Permanent link">&para;</a></h3>
<p>Files and directories created in /run and /var/run only survive until
the next reboot. However, if reboots are infrequent, an easy solution
while still utilizing the default locations is to create the
required directories manually. To do this execute the following commands.</p>
<p>daos_server:</p>
<pre><code class="bash">$ mkdir /var/run/daos_server
$ chmod 0755 /var/run/daos_server
$ chown user:user /var/run/daos_server (where user is the user you
    will run daos_server as)
</code></pre>

<p>daos_agent:</p>
<pre><code class="bash">$ mkdir /var/run/daos_agent
$ chmod 0755 /var/run/daos_agent
$ chown user:user /var/run/daos_agent (where user is the user you
    will run daos_agent as)
</code></pre>

<h3 id="default-directory-persistent">Default Directory (persistent)<a class="headerlink" href="#default-directory-persistent" title="Permanent link">&para;</a></h3>
<p>If the server hosting <code>daos_server</code> or <code>daos_agent</code> will be rebooted often,
systemd provides a persistent mechanism for creating the required
directories called tmpfiles.d. This mechanism will be required every
time the system is provisioned and requires a reboot to take effect.</p>
<p>To tell systemd to create the necessary directories for DAOS:</p>
<ul>
<li>
<p>Copy the file utils/systemd/daosfiles.conf to /etc/tmpfiles.d\
    cp utils/systemd/daosfiles.conf /etc/tmpfiles.d</p>
</li>
<li>
<p>Modify the copied file to change the user and group fields
    (currently daos) to the user daos will be run as</p>
</li>
<li>
<p>Reboot the system, and the directories will be created automatically
    on all subsequent reboots.</p>
</li>
</ul>
<h2 id="elevated-privileges">Elevated Privileges<a class="headerlink" href="#elevated-privileges" title="Permanent link">&para;</a></h2>
<p>DAOS employs a privileged helper binary (<code>daos_admin</code>) to perform tasks
that require elevated privileges on behalf of <code>daos_server</code>.</p>
<h3 id="privileged-helper-configuration">Privileged Helper Configuration<a class="headerlink" href="#privileged-helper-configuration" title="Permanent link">&para;</a></h3>
<p>When DAOS is installed from RPM, the <code>daos_admin</code> helper is automatically installed
to the correct location with the correct permissions. The RPM creates a "daos_server"
system group and configures permissions such that <code>daos_admin</code> may only be invoked
from <code>daos_server</code>.</p>
<p>For non-RPM installations, there are two supported scenarios:</p>
<ol>
<li><code>daos_server</code> is run as root, which means that <code>daos_admin</code> is also invoked as root,
and therefore no additional setup is necessary.</li>
<li><code>daos_server</code> is run as a non-root user, which means that <code>daos_admin</code> must be
manually installed and configured.</li>
</ol>
<p>The steps to enable the second scenario are as follows (steps are assumed to be
running out of a DAOS source tree which may be on a NFS share):</p>
<pre><code class="bash">$ chmod -x $daospath/bin/daos_admin # prevent this copy from being executed
$ sudo cp $daospath/bin/daos_admin /usr/bin/daos_admin
$ sudo chmod 4755 /usr/bin/daos_admin # make this copy setuid root
$ sudo mkdir -p /usr/share/daos/control # create symlinks to SPDK scripts
$ sudo ln -sf $daospath/share/daos/control/setup_spdk.sh \
           /usr/share/daos/control
$ sudo mkdir -p /usr/share/spdk/scripts
$ sudo ln -sf $daospath/share/spdk/scripts/setup.sh \
           /usr/share/spdk/scripts
$ sudo ln -sf $daospath/share/spdk/scripts/common.sh \
           /usr/share/spdk/scripts
$ sudo ln -s $daospath/include \
           /usr/share/spdk/include
</code></pre>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The RPM installation is preferred for production scenarios. Manual
installation is most appropriate for development and predeployment
proof-of-concept scenarios.</p>
</div>
<h2 id="memory-lock-limits">Memory Lock Limits<a class="headerlink" href="#memory-lock-limits" title="Permanent link">&para;</a></h2>
<p>Low ulimit for memlock can cause SPDK to fail and emit the following error:</p>
<pre><code class="bash">daos_engine:1 EAL: cannot set up DMA remapping, error 12 (Cannot allocate
    memory)
</code></pre>

<p>The memlock limit only needs to be manually adjusted when <code>daos_server</code> is not
running as a systemd service. Default ulimit settings vary between OSes.</p>
<p>For RPM installations, the service will typically be launched by systemd and
the limit is pre-set to unlimited in the <code>daos_server.service</code> unit file:
https://github.com/daos-stack/daos/blob/master/utils/systemd/daos_server.service#L16.
Note that values set in <code>/etc/security/limits.conf</code> are ignored by services
launched by systemd.</p>
<p>For non-RPM installations where <code>daos_server</code> is launched directly from the
commandline, limits should be adjusted in <code>/etc/security/limits.conf</code> as per
https://software.intel.com/content/www/us/en/develop/blogs/best-known-methods-for-setting-locked-memory-size.html.</p>
                
                  
                
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../installation/" title="Software Installation" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Software Installation
              </span>
            </div>
          </a>
        
        
          <a href="../deployment/" title="System Deployment" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                System Deployment
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org" target="_blank" rel="noopener">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
<script src="../../assets/javascripts/application.c33a9706.js"></script> 
<script src="../../js/jquery-3.4.1.min.js"></script> 
<script src="../../js/popper.min.js"></script> 
<script src="../../js/bootstrap-4.4.1.js"></script> 
<script>app.initialize({version:"1.1.2",url:{base:".."}})</script>
</body>
</html>