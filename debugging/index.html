<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="DAOS Project">
    <link rel="canonical" href="http://daos.io/debugging/">
    <link rel="shortcut icon" href="../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>DAOS Debugging - DAOS</title>
    <link href="../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../js/jquery-3.2.1.min.js"></script>
    <script src="../js/bootstrap-3.3.7.min.js"></script>
    <script src="../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "DAOS Debugging", url: "#_top", children: [
              {title: "Registered Subsystems/Facilities", url: "#registered-subsystemsfacilities" },
              {title: "Priority Logging", url: "#priority-logging" },
              {title: "Debug Masks/Streams:", url: "#debug-masksstreams" },
              {title: "Common Use Cases", url: "#common-use-cases" },
          ]},
        ];

    </script>
    <script src="../js/base.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    

    <h1 id="daos-debugging">DAOS Debugging</h1>
<p>DAOS uses the debug system defined in <a href="https://github.com/daos-stack/cart">CaRT</a>
but more specifically the GURT library. Logging for both client and server are
written to "/tmp/daos.log" unless otherwise set by <code>D_LOG_FILE</code>.</p>
<h2 id="registered-subsystemsfacilities">Registered Subsystems/Facilities</h2>
<p>The debug logging system includes a series of subsystems or facilities which
define groups for related log messages (defined per source file). There are
common facilities which are defined in GURT, as well as other facilities that
can be defined on a per-project basis (such as those for CaRT and DAOS).
<code>DD_SUBSYS</code> can be used to set which subsystems to enable logging for. By
default all subsystems are enabled ("DD_SUBSYS=all").
- DAOS Facilities: [common, tree, vos, client, server, rdb, pool, container,
            object, placement, rebuild, tier, mgmt, eio, tests]
- Common Facilities (GURT): [MISC, MEM]
- CaRT Facilities: [RPC, BULK, CORPC, GRP, LM, HG, PMIX, ST, IV]</p>
<h2 id="priority-logging">Priority Logging</h2>
<p>All macros which output logs have a priority level, shown in decending order
below.
- D_FATAL(fmt, ...)     FATAL
- D_CRIT(fmt, ...)      CRIT
- D_ERROR(fmt, ...)     ERR
- D_WARN(fmt, ...)      WARN
- D_NOTE(fmt, ...)      NOTE
- D_INFO(fmt, ...)      INFO
- D_DEBUG(mask, fmt, ...)   DEBUG</p>
<p>The priority level that outputs to stderr can be set with <code>DD_STDERR</code>. By
default in DAOS (specific to project), this is set to CRIT ("DD_STDERR=CRIT")
meaning that all CRIT and more severe log messages will dump to stderr. This
however is separate from the priority of logging to "/tmp/daos.log". The
priority level of logging can be set with <code>D_LOG_MASK</code>, which by default is set
to INFO ("D_LOG_MASK=INFO"), which will result in all messages excluding DEBUG
messages being logged. <code>D_LOG_MASK</code> can also be used to specify the level of
logging on a per-subsystem basis as well ("D_LOG_MASK=DEBUG,MEM=ERR").</p>
<h2 id="debug-masksstreams">Debug Masks/Streams:</h2>
<p>DEBUG messages account for a majority of the log messages, and finer-granularity
might be desired. Mask bits are set as the first argument passed in
D_DEBUG(mask, ...). In order to accomplish this, <code>DD_MASK</code> can be set to enable
different debug streams. Similar to facilities, there are common debug streams
defined in GURT, as well as other streams that can defined on a per-project
basis (CaRT and DAOS). All debug streams are enabled by default ("DD_MASK=all").
- DAOS Debug Masks:
    - md = metadata operations
    - pl = placement operations
    - mgmt = pool management
    - epc = epoch system
    - df = durable format
    - rebuild = rebuild process
    - daos_default = (group mask) io, md, pl, and rebuild operations
- Common Debug Masks (GURT):
    - any = generic messages, no classification
    - trace = function trace, tree/hash/lru operations
    - mem = memory operations
    - net = network operations
    - io = object I/O
    - test = test programs</p>
<h2 id="common-use-cases">Common Use Cases</h2>
<ul>
<li>
<p>Generic setup for all messages (default settings)
    $ D_LOG_MASK=DEBUG
    $ DD_SUBSYS=all
    $ DD_MASK=all</p>
</li>
<li>
<p>Disable all logs for performance tuning
    $ D_LOG_MASK=ERR -&gt; will only log error messages from all facilities
    $ D_LOG_MASK=FATAL -&gt; will only log system fatal messages</p>
</li>
<li>
<p>Disable a noisy debug logging subsystem
    $ D_LOG_MASK=DEBUG,MEM=ERR -&gt; disables MEM facility by restricting all
    logs from that facility to ERROR or higher priority only</p>
</li>
<li>
<p>Enable a subset of facilities of interest
    $ DD_SUBSYS=rpc,tests
    $ D_LOG_MASK=DEBUG -&gt; required to see logs for RPC and TESTS less severe
    than INFO (majority of log messages)</p>
</li>
<li>
<p>Fine-tune the debug messages by setting a debug mask
    $ D_LOG_MASK=DEBUG
    $ DD_MASK=mgmt -&gt; only logs DEBUG messages related to pool management</p>
</li>
</ul>
<p><strong>See <a href="../environ/">DAOS Environment Variables</a> documentation for more info
about debug system environment.</strong></p>

  <br>
    

    <br>
</div>

<footer class="col-md-12 wm-page-content">
      <p>
        <a href="https://github.com/daos-stack/daos/edit/master/docs/debugging.md">Edit on daos-stack/daos</a>
      </p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>